# ATravelerRecognizeImage
图像识别旅者

| :exclamation: 免责声明<br>本脚本使用后果均为使用者个人承担<br>The consequence of using this script must be undertaken by user. |
| ------------------------------------------------------------------------------------------------------------------------- |

主要使用pyautogui的库实现，以及使用gooey库制作了GUI

## 功能
- [x] 支持图形化界面
  - [x] 自定义excel和图片路径
  - [x] 使用checkbox选择是否循环和跳过匹配不到的图片
  - [x] 设置菜单，显示关于文本
- [x] 指令功能
  - [x] 多次匹配不到一个指令可以跳过该指令
  - [x] 可以设置只执行一次的指令
- [x] 鼠标功能
  - [x] 单击
  - [x] 双击
  - [x] 右键
  - [x] 移动到指定图片的位置
  - [ ] 自定义点击位置（非默认的图片中心）
  - [ ] 长按鼠标拖拽
- [x] 输入功能
  - [x] 文本输入
  - [x] 键盘按键键入
  - [ ] 按键可以长按
- [x] 等待功能
  - [x] 用户自定义每一步等待时长
- [x] 滚轮功能
  - [ ] 优化控制滚动距离
- [ ] 判断功能
  - [ ] 图片判断
- [x] 截图功能
  - [x] 截全屏
  - [x] 自定义范围
  - [x] 保存截图，命名为“字母+数字”组合
- [x] 用户自定义鼠标参数
- [x] 优化gui界面
- [ ] 可以在浏览器控制台中输入自定义的js代码


## 使用方法：
在commands.xlsx文件中配置每一步的指令，根据表格提示填入对应的内容，指令123456789，分别具备单击，双击，右键单击，输入，等待，滚动，移动，截图，键盘按键的功能。

关于重复：对于单一指令的重复，当重复过程中多次匹配失败则会跳出重复，执行下一条指令。

点击ATRI.py文件运行。
## 注意事项
python版本不要高于3.9，3.9版本改变了xlrd包中部分函数名的使用，在读取xlsx文件会异常。（解决方案：找到xlrd包的位置，打开`` xlsx.py ``文件,查找里面的`` getiterator``()函数，全部替换成`` iter()``，保存关闭后即可。）
指令文件（commands.xlsx）需放在根目录中，放在文件夹中需要手动调整路径。

鼠标点击和移动默认为图片的中心位置，所以需要在截图的时候考虑，另外图片不易过小，会增加识别时长（虽然影响不大）

## 安装依赖
在项目根目录shift+右键，打开Powershell窗口，执行：
```
pip install -r requirements.txt
```

## 更新 
### v1.4
改变了单一指令重复执行的逻辑，如果在重复执行的过程中图片匹配失败10次，则会跳出循环，不再重复，进而执行下一条指令。防止卡壳。

实现了可以添加只执行一次的指令的功能。

### v1.3
没事做重新捡起来优化一下，改变了gui界面，优化了文件的格式和排布，增加了代码可读性。
同时增加了键盘按键的功能，不过目前只做了按下立即释放的功能，后续会增加长按(延迟释放)的功能。

### v1.2
添加了截图功能，可以自定义截图范围，图片保存的文件夹也可以自定义。
添加了自定义鼠标参数的功能，点击间隔和执行时鼠标移动持续时间，默认均为0.2

### v1.1
改了功能“7”为移动鼠标，判断功能后面再补。

主要添加了是否循环和匹配不到自动跳过的功能，图片也支持手动输入文件夹检索了。

### v1.0
这是一个基于图片匹配的自动操作脚本，可以实现部分软件操作的自动化。

我根据gooey库，制作了一个图形化界面，用来调用参数和用户选项。


